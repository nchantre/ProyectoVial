# ADR-002: CQRS con MediatR

## Estado
Aceptado

## Contexto
Se requiere separar las operaciones de lectura y escritura para:
- Mejorar la claridad del código
- Facilitar el mantenimiento
- Permitir optimizaciones independientes
- Cumplir con los criterios de evaluación que exigen CQRS

## Decisión
Implementar **CQRS (Command Query Responsibility Segregation)** usando **MediatR**:

- **Commands**: Operaciones de escritura (CreateSiniestroCommand)
- **Queries**: Operaciones de lectura (GetSiniestrosQuery, GetSiniestroByIdQuery)
- **Handlers**: Procesadores separados para cada Command/Query
- **MediatR**: Librería que implementa el patrón Mediator para desacoplar Commands/Queries de sus handlers

## Estructura

```
Application/
├── Commands/
│   └── Siniestros/
│       ├── CreateSiniestroCommand.cs
│       └── Handlers/
│           └── CreateSiniestroCommandHandler.cs
└── Queries/
    └── Siniestros/
        ├── GetSiniestrosQuery.cs
        ├── GetSiniestroByIdQuery.cs
        └── Handlers/
            ├── GetSiniestrosQueryHandler.cs
            └── GetSiniestroByIdQueryHandler.cs
```

## Flujo de Ejecución

1. **Controller** recibe request HTTP
2. **Controller** crea Command/Query y lo envía a MediatR
3. **MediatR** encuentra el Handler correspondiente
4. **Handler** ejecuta la lógica de negocio
5. **Handler** retorna resultado al Controller
6. **Controller** retorna respuesta HTTP



