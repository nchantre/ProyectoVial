# ADR-001: Clean Architecture

## Estado
Aceptado

## Contexto
Se requiere desarrollar una API REST para gestión de siniestros viales que cumpla con criterios de evaluación específicos:
- Separación clara de responsabilidades
- Flujo de dependencias correcto entre capas
- Mantenibilidad y extensibilidad
- Facilidad para realizar pruebas unitarias

## Decisión
Implementar **Clean Architecture** (Arquitectura Limpia) con separación en 4 capas:

1. **Domain Layer** (SiniestrosViales.Domain)
   - Entidades de dominio
   - Value Objects
   - Interfaces de repositorio
   - Sin dependencias externas

2. **Application Layer** (SiniestrosViales.Application)
   - Casos de uso (Commands/Queries)
   - DTOs
   - Validaciones
   - Mapeos
   - Depende solo de Domain

3. **Infrastructure Layer** (SiniestrosViales.Infrastructure)
   - Implementación de repositorios
   - Entity Framework Core
   - Configuraciones de BD
   - Depende solo de Domain

4. **API Layer** (SiniestrosViales.API)
   - Controladores REST
   - Middleware
   - Configuración de servicios
   - Depende de Application e Infrastructure

## Flujo de Dependencias

```
API → Application → Domain
     ↓
Infrastructure → Domain
```

**Regla crítica**: Infrastructure NO debe referenciar Application.

## Consecuencias

### Positivas
- ✅ Separación clara de responsabilidades
- ✅ Facilidad para realizar pruebas unitarias (Domain e Application son independientes)
- ✅ Flexibilidad para cambiar la implementación de infraestructura sin afectar lógica de negocio
- ✅ Cumple con principios SOLID (especialmente Dependency Inversion)
- ✅ Facilita el mantenimiento y la extensibilidad

### Negativas
- ⚠️ Mayor complejidad inicial en la estructura del proyecto
- ⚠️ Más archivos y carpetas que en una arquitectura monolítica
- ⚠️ Requiere disciplina para mantener las dependencias correctas

## Alternativas Consideradas

1. **Arquitectura en Capas Tradicional**
   - Rechazada: No garantiza la inversión de dependencias
   - Las capas superiores dependen de las inferiores, dificultando las pruebas

2. **Arquitectura Hexagonal (Ports and Adapters)**
   - Considerada pero rechazada: Más compleja de lo necesario para este proyecto
   - Clean Architecture es más simple y cumple con los requisitos

3. **Arquitectura Monolítica Simple**
   - Rechazada: No cumple con los criterios de evaluación
   - Dificulta las pruebas y el mantenimiento

## Referencias

- [Clean Architecture by Robert C. Martin](https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html)
- [Microsoft - Clean Architecture](https://learn.microsoft.com/en-us/dotnet/architecture/modern-web-apps-azure/common-web-application-architectures)
